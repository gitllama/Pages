# Redmineを使用した製造のシステム化

## 3. Redmine設定検討

### 3-1. データ構造

- issue_subjectで連番紐つけ管理（issue_noだとDB移管時に壊れる）

**外部データ管理**

- 機種データ（マスクセット/使用ファブ/標準条件
- 顧客情報（コード/顧客名/届け先
- TAT
- 機種データ
  - 種類名（品番）
  - ロット名ルール
  - TAT（各工程）
  - 在庫調整数
  - （実在庫）
  - 状態（continue/discon）/ヴァージョン
  
等データを一括管理する場が必要  
例えば 機種情報が多すぎて管理が困難 = ハンドリングはもっと困難 なのでそもそも避けるべき

- Gitでの差分管理
- Redmine-wiki内にYaml表記
- MySQLアクセス
- ローカルSQLiteアクセス

等選択肢

- Wiki -> 正規表現でYaml抜出 -> デシリアライズ

は変更管理（変更権限）のハードル低そう

### 3-2. 入力UI

- JsonよりYamlは見やすい。Previewがインデントを消すがView customizeで対応可

### 3-3. 出力UI

帳票機能とPreviewはなるべく一致させたい。

- MarkdownのライブラリはGFM未対応が多く却下
- AsciiDocも開発途上で却下
- PDFはiTextが使用できるが、置換処理は不可能（Adobeフォント縛り）
- PDF直書きはつらい
- html to pdfライブラリある（フォント問題でペンディング

単純なHTMLのbootstrapレイアウトに印刷cssつけることで暫定。

**帳票のフォーマット作成に関しては**

- htmlは出力できるソフトはそれなりに多彩
- html生成はscriptも生成するの注意
- htmlはgitからも直接読める（保存先を選ばない）
- Markdownからもhtml生成できる
- Excelからも生成できる（UTF-8化とリンク修正は必要

が、考えるのが面倒くさくなったのでReactでライブラリ作成しJSONから生成

**PDF化**

iTextではいてもよいが、単純に右クリック印刷で十分（ヘッダ/フッタの扱い注意, chromeならcssで消せる）

### 3-4. ワークフロー管理

分岐など複雑な管理を行わない限りRedmineのワークフローでフォローできる

ポイント

- 作成・発行者のみ編集
- 照査はコメントとステータス移動のみ
- 承認者はコメントを確認したうえで、承認か差し戻しの選択
- 作業者が作業結果を入れる欄作る
